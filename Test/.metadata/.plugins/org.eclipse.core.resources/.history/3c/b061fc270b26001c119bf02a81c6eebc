import java.util.NoSuchElementException;
import java.util.LinkedList;

public interface MapADT<KeyType, ValueType> {

	public boolean put(KeyType key, ValueType value);
	public ValueType get(KeyType key) throws NoSuchElementException;
	public int size();
	public boolean containsKey(KeyType key);
	public ValueType remove(KeyType key);
	public void clear();
	
}

class Pair<KeyType,ValueType>{
	KeyType key;
	ValueType value;
	public Pair(KeyType key, ValueType value) {
		this.key=key;
		this.value=value;
	}
	public KeyType key() {
		return key;
	}
	public ValueType value() {
		return value;
	}
}



public class Test_2<KeyType,ValueType> implements MapADT{
	int KL_size=0;
	LinkedList<Pair> [] key_list;

	public Test_2()
	{
		this.KL_size=20;
		this.key_list=new LinkedList[this.KL_size];
	}
	
	public Test_2(int capacity)
	{
		this.KL_size=capacity;		
		this.key_list=new LinkedList[this.KL_size];
		
	}
	
	public boolean containsKey(KeyType key)
	{
		int location = (int)key%this.KL_size;
		
		if (this.key_list[location] == null) {
			return false;		
		}
		
		for(int i=0; i<this.key_list[location].size(); i++ )
		{
			if (this.key_list[location].get(i).key() == key)
				return true;
		}
		
		return false;
	}
	
	public boolean put(KeyType key, ValueType value)
	{
		int location = (int) key%this.KL_size;
		
		if (this.key_list[location] == null) {
			Pair pair = new Pair(key, value);
			this.key_list[location]= new LinkedList<Pair>();						
			this.key_list[location].add(pair);
			
			if(this.check()== true) 
				this.twice();
			
			return true;
		}
		else
		{
			if (containsKey(key) == true)
				return false;
			else
			{
				Pair pair = new Pair(key, value);
				this.key_list[location].add(pair);
								
				return true;
			}
		}
		
		
	}
	
	public boolean check()
	{
		int count=0;
		for (int i=0; i<this.KL_size;i++)
		{
			if (this.key_list[i] != null)
				count++;
		}
		double ratio_k = ((double) count)/KL_size;		
		if(ratio_k >= 0.8)
		{
			return true;
		}
		return false;
	}
	
	public void twice() {
		int temp_size=this.KL_size*2;
		LinkedList<Pair> [] tmp_key_list= new LinkedList[temp_size];	
		
		for (int i=0; i<this.KL_size;i++)
		{
			if (this.key_list[i] != null)
			{
				for(int j=0; j<this.key_list[i].size();j++)
				{
					int location = (int)this.key_list[i].get(j).key() %temp_size;
					
					if (tmp_key_list[location] == null) {
						tmp_key_list[location]= new LinkedList<Pair>();	
						tmp_key_list[location].add(new Pair(this.key_list[i].get(j).key(), this.key_list[i].get(j).value()) );
					}
					else {
						tmp_key_list[location].add(new Pair(this.key_list[i].get(j).key(), this.key_list[i].get(j).value()) );
					}
				}
			}
		}
		this.key_list=tmp_key_list;
		this.KL_size=temp_size;
	}			

	
	public ValueType get(KeyType key) throws NoSuchElementException
	{
		int location = (int)key%this.KL_size;
		
		if (this.key_list[location] == null) {
			System.out.println("None");
			throw new NoSuchElementException();
		}
		else
		{
			for(int i=0; i<this.key_list[location].size(); i++ )
			{				
				if (this.key_list[location].get(i).key() == key)
					return (ValueType)this.key_list[location].get(i).value();
			}
			throw new NoSuchElementException();
		}
	}
		
	public ValueType remove(KeyType key)
	{
		if (containsKey(key) == true)
		{
			int location = (int)key%this.KL_size;
			for(int i=0; i<this.key_list[location].size(); i++ )
			{
				if (this.key_list[location].get(i).key() == key)
				{
					ValueType rvalue=(ValueType)key_list[location].get(i).value();
					key_list[location].remove(i);
					
					return (ValueType)rvalue;
				}
			}
		}	
		System.out.println("no key");
		return null;	
	}
	
	public void clear()
	{
		for (int i=0; i<this.KL_size; i++)
			this.key_list[i]=null;		
	}
	
	public int size() 
	{
		int count=0;
		for (int i=0; i<this.KL_size;i++)
		{
			if (this.key_list[i] != null)
				count += this.key_list[i].size();			
		}
		return count;
	}
	
	
	
	
	public static void main (String args[]) {
		
		Test_2 a= new Test_2(6);
		System.out.println(a.size());
		System.out.println("0번 put함수 테스트");
		a.put(1,1.34);
		a.put(2,'A');
		a.put(3,3);
		System.out.println("1번 put함수 테스트");
		System.out.println(a.get(1));
		System.out.println(a.get(2));
		System.out.println(a.get(3));
		System.out.println("2번 size함수 테스트");
		System.out.println(a.size());
		a.put(4,100);
		a.put(5,100);
		a.put(6,100);
		a.put(7,100);
		System.out.println("3번 twice함수 테스트");
		System.out.println("4번 size함수 테스트");
		System.out.println(a.size());
		
		System.out.println("5번 containskey함수 테스트");
		System.out.println(a.containsKey(1));
		System.out.println(a.containsKey(99));
		
		System.out.println("6번 remove함수 테스트");
		System.out.println(a.remove(2));
		System.out.println(a.remove(99));

		System.out.println("****************");
		a.put(7777,190);
		a.put(18,999);
		a.put(9,100);
		a.put(10,100);
		a.put(11,100);
		a.put(12,100);
		a.put(13,100);
		a.put(32,100);

		System.out.println(a.get(1));
		//System.out.println(a.get(38));
		//a.get(22);
		System.out.println(a.get(10));
		//System.out.println(a.get(7777));
		a.remove(32);
		a.remove(32);
		//a.remove(37);
		System.out.println(a.size());
		
	}

}



/*
//System.out.println("배열의 갯수"+a.size());
		//System.out.println("배열의 size"+a.KL_size);
		//a.put(6,100);
		//a.put(7,100);
		//a.put(8,100);
		//a.put(9,100);
		//a.put(10,100);
		//System.out.println("배열의 갯수"+a.size());
		//System.out.println("배열의 size"+a.KL_size);
		//a.put(11,200);
		//a.put(12,200);
		//a.put(13,200);
		//a.put(14,200);
		//System.out.println("배열의 갯수"+a.size());
		//System.out.println("배열의 size"+a.KL_size);
		//a.put(15,200);
		//a.put(16,200);
		//a.put(17,200);
		//a.put(18,200);
		//a.put(19,200);
		//a.put(20,200);
		//System.out.println("배열의 갯수"+a.size());
		//System.out.println("배열의 size"+a.KL_size);
		//a.put(31,300);
		//a.put(32,300);
		//a.put(33,300);
		//a.put(34,300);
		//System.out.println("배열의 갯수"+a.size());
		//System.out.println("배열의 size"+a.KL_size);
		a.put(35,300);
		a.put(36,300);
		a.put(37,300);
		a.put(38,300);
		a.put(39,300);
		a.put(30,300);
*/
